<!-- <div class="loader-background" *ngIf="loading">
    <div class="loader"></div>
</div> -->
<div id="loading" *ngIf="loading">
    <img id="loading-image" src="assets/images/loading.gif" />
</div>
<div class="main-container">
    <div class="header">
        <div class="row">
            <h3 class="page-title">Manage Team</h3>
            <a [routerLink]="['/dashboard/default']">
                <i class="fa fa-3x fa-home home-icon" aria-hidden="true" title="Dashboard" data-toggle="tooltip"></i>
            </a>
        </div>
    </div>
    <div id="content" class="body-container">
            <!-- <div class="loader" *ngIf="loading"></div> -->
        <div class="row">
            <div class="col-lg-2 col-md-2 left filter-list">
                <div class="align-center text-center">
                    <h4>
                        <i class="fa fa-users" aria-hidden="true"></i>&nbsp;Teams</h4>
                    <hr>
                    <div class="align-center text-center">
                        <div class="form-group input-group" style="padding-top:5px;">
                            <input type="text" class="form-control" placeholder="Search" [(ngModel)]="searchTeam">
                            <div class="input-group-append">
                                <button class="btn btn-search" type="button">
                                    <i class="fa fa-search"></i>
                                </button>
                            </div>
                            <button class="btn btn-sec" style="align:align-center; margin-left: 5px;" (click)="open()"
                                #addTeamField>+Team</button>
                        </div>
                    </div>
                </div>
                <div class="team-name-list">
                    <ul *ngFor="let userPermission of userPermissionList  | genericSearchAllProp:searchTeam ;let teamIndex = index">
                        <li>
                            <label *ngIf="userPermission.team.status.status === 'ACTIVE'" style=" cursor: pointer;"
                                (click)="displayTeamDetails(userPermission , teamIndex)">
                                {{userPermission.team.teamName}}
                            </label>
                        </li>
                    </ul>
                </div>
                <div style="text-align:center;">
                    <app-custom-modal #addNewTeamModal [model]="newTeam" (CancelEvent)="clearTeamPopupField()">
                        <div class="modal-body row-label">
                            <div class="row">
                                <div class="col-md-3">
                                    <label>Team Name</label>
                                </div>
                                <div>
                                    <textarea placeholder="Team Name" [(ngModel)]="newTeamName" #teamNameField value="{{newTeamName}}"></textarea>
                                </div>
                            </div>
                        </div>
                        <div class="modal-footer popFooter">
                            <button type="button" class="btn btn-primary" (click)="addTeam()">Add Team</button>
                            <button type="button" class="btn btn-danger" (click)="closePopup('addNewTeam')">Close</button>
                        </div>
                    </app-custom-modal>
                </div>
            </div>
            <!-- <div class="loader" *ngIf="loading"></div> -->
            <div class="col-lg-10 col-md-10" *ngIf="!showSelectedTeam">
                <h3>Kindly select the team to view details</h3>
            </div>
            <div class="col-lg-10 col-md-10 team-container" *ngIf="showSelectedTeam">
                <div class="row" style="padding: 5px;">
                    <h4 class="team-name">{{selectedTeamName}}
                        <span>&nbsp;[{{filterMemberList.length}} Members]</span>
                    </h4>
                    <button (click)="editTeam()" class="btn btn-primary" style="margin-right: 5px;" #editTeamField>
                        <i class="fa fa-pencil-square-o"></i>
                    </button>
                    <button (click)="deleteSelectedTeam()" class="btn btn-danger" #deleteTeamField>
                        <i class="fa fa-trash-o"></i>
                    </button>
                    <hr>
                </div>
                <div class="row">
                    <div class="col-md-9">
                        <button class="btn btn-sec" (click)="openMemberPopup()" #addMemField>+Member</button>
                    </div>
                    <div class="align-center" class="col-md-3">
                        <div class="form-group input-group" style="padding-top:5px;">
                            <input type="text" class="form-control" placeholder="Name/Email/Status" [(ngModel)]="searchTableText">
                            <div class="input-group-append">
                                <button class="btn btn-search" type="button">
                                    <i class="fa fa-search"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <hr>
                <table style="padding: 20px;">
                    <tr>
                        <th>Sr. No</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Status</th>
                        <th>Meeting Permission</th>
                        <th>Edit</th>
                        <th>Delete</th>
                    </tr>
                    <tr *ngFor="let userMemPermission of filterMemberList  | genericSearchAllProp:searchTableText | paginate: config ;let srNo = index">
                        <td> {{ config.itemsPerPage * (config.currentPage - 1) + srNo + 1 }}</td>
                        <td>{{userMemPermission.userId.firstName}}&nbsp;{{userMemPermission.userId.lastName}}</td>
                        <td>{{userMemPermission.userId.email}}</td>
                        <td>{{userMemPermission.userId.status.status}} </td>
                        <td><i class="fa fa-check" aria-hidden="true" style="color: rgb(4, 165, 4);" *ngIf="userMemPermission.userId.meetingPermissionStatus.status === 'ACTIVE'"></i>
                            <i class="fa fa-times" aria-hidden="true" style="color: red" *ngIf="userMemPermission.userId.meetingPermissionStatus.status === 'INACTIVE'"></i></td>
                        <td>
                            <i class="fa fa-pencil-square-o edit-icon" (click)="editMember(userMemPermission);"></i>
                        </td>
                        <td>
                            <i class="fa fa-trash-o delete-icon" (click)="deleteMemberPopup(userMemPermission);"></i>
                        </td>
                    </tr>
                </table>
                <div class="pageControl" style="text-align:center;">
                    <pagination-controls [id]="config.id" [maxSize]="maxSize" [directionLinks]="directionLinks"
                        [autoHide]="autoHide" [responsive]="responsive" [previousLabel]="labels.previousLabel"
                        [nextLabel]="labels.nextLabel" [screenReaderPaginationLabel]="labels.screenReaderPaginationLabel"
                        [screenReaderPageLabel]="labels.screenReaderPageLabel" [screenReaderCurrentLabel]="labels.screenReaderCurrentLabel"
                        (pageChange)="onPageChange($event)"></pagination-controls>
                </div>

                <app-custom-modal #addUpdateTeamModal [model]="updateTeam" (CancelEvent)="teamCloseEditPopup()">
                    <div class="modal-body row-label">
                        <div class="row">
                            <div class="col-md-3">
                                <label>Team Name</label>
                            </div>
                            <div>
                                <textarea placeholder="Team Name" [(ngModel)]="updateTeamName" value="{{updateTeamName}}"></textarea>
                            </div>
                        </div>
                    </div>
                    <div class="modal-footer popFooter">
                        <button type="button" class="btn btn-primary" (click)="updateTeamDetails()">Update Team</button>
                        <button type="button" class="btn btn-danger" (click)="addUpdateTeamModal.close()">Close</button>
                    </div>
                </app-custom-modal>
                <app-custom-modal #deleteTeamModal [model]="deleteTeam" (CancelEvent)="teamCloseDeletePopup(2)">
                    <div>
                        <label style="padding: 10px; ">Are you sure you want to delete this team?</label>
                    </div>
                    <div class="modal-footer popFooter">
                        <button type="button" class="btn btn-primary" (click)="deleteTeamDetails()">Yes</button>
                        <button type="button" class="btn btn-danger" (click)="deleteTeamModal.close()">No</button>
                    </div>
                </app-custom-modal>

                <app-custom-modal #addNewMemberModal [model]="newMember" (CancelEvent)="closePopup('addNewMember')">
                    <div class="modal-body row-label" >
                        <div class="row form-group">
                                <label class="member-field-name">First Name</label>
                                <input placeholder="First Name" type="text" class="form-control member-field-value" [(ngModel)]="firstName"
                                    required />
                        </div>
                        <div class="row form-group">
                                <label class="member-field-name">Last Name</label>
                                <input placeholder="Last Name" type="text" class="form-control member-field-value" [(ngModel)]="lastName"
                                    required />
                        </div>
                        <div class="row form-group">
                                <label class="member-field-name">Email</label>
                                <input placeholder="Email" type="text" class="form-control member-field-value" [(ngModel)]="email"
                                    #emailField required />
                        </div>
                        <div class="row form-group">
                                <label class="member-field-name">UserName</label>
                                <input type="text" placeholder="UserName" class="form-control member-field-value" [(ngModel)]="userName"
                                    required />
                        </div>
                        <div class="row form-group">
                                <label class="member-field-name">Password</label>
                                <input placeholder="Password" class="form-control member-field-value" type="text" [(ngModel)]="password"
                                    type="password" required />
                        </div>
                        <div class="row form-group">
                                <label class="member-field-name">Meeting Permission</label>
                                <input type="checkbox" style="width: 5%; margin-top: 6%;" class="form-control" id="meetingStatusChk" [(ngModel)]="meetingPermissionStatus">
                                <p id="meetingText" style="display:none" class="member-field-value">Meeting Permission Checkbox is CHECKED!</p>
                        </div>
                    </div>
                    <div class="modal-footer popFooter">
                        <button type="button" class="btn btn-primary" (click)="addMember()">Add Member</button>
                        <button type="button" class="btn btn-danger" (click)="addNewMemberModal.close()">Close</button>
                    </div>
                </app-custom-modal>
                <app-custom-modal #UpdateMemberModal [model]="updateMember" (CancelEvent)="cancelEditPopup()">
                    <div class="modal-body row-label">
                        <div class="row form-group">
                                <label class="member-field-name">First Name</label>
                                <input placeholder="First Name" type="text" class="form-control member-field-value" [(ngModel)]="updatedFirstName"
                                    required />
                        </div>
                        <div class="row form-group">
                                <label class="member-field-name">Last Name</label>
                                <input placeholder="Last Name" type="text" class="form-control member-field-value" [(ngModel)]="updatedLastName"
                                    required />
                        </div>
                        <div class="row form-group">
                                <label class="member-field-name">Email</label>
                                <input placeholder="Email" class="form-control member-field-value" type="text" [(ngModel)]="updatedEmail"
                                    #emailField required />
                        </div>
                        <div class="row form-group">
                                <label class="member-field-name">Status</label>
                                <input type="checkbox"  style="width: 5%; margin-top: 4%;" class="form-control" id="statusChk" [(ngModel)]="updatedUserStatus">
                                <p id="text" style="display:none" class="member-field-value">Checkbox is CHECKED!</p>
                        </div>
                        <div class="row form-group">
                            <label  class="member-field-name">Meeting Permission</label>
                            <input type="checkbox" class="form-control" style="width: 5%; margin-top: 4%;" id="updatedSeetingStatusChk" [(ngModel)]="updatedMeetingPermissionStatus">
                            <p id="updatedMeetingText" style="display:none" class="member-field-value">Meeting Permission Checkbox is CHECKED!</p>
                        </div>
                    </div>
                    <div class="modal-footer popFooter" >
                        <button type="button" class="btn btn-primary" (click)="updateMemberDetails()">Update
                            Member</button>
                        <button type="button" class="btn btn-danger" (click)="UpdateMemberModal.close()">Close</button>
                    </div>
                </app-custom-modal>
                <app-custom-modal #deleteMemberModal [model]="deleteMember" (CancelEvent)="cancelDeletePopup(2 , 1)">
                    <div>
                        <label style="padding: 10px; ">Are you sure you want to delete this member?</label>
                    </div>
                    <div class="modal-footer popFooter">
                        <button type="button" class="btn btn-primary" (click)="deleteMemberDetails()">Yes</button>
                        <button type="button" class="btn btn-danger" (click)="deleteMemberModal.close()">No</button>
                    </div>
                </app-custom-modal>
            </div>
            <div id="footer" class="footer">
                <div class="cfsfooter">
                    <img class="card-img setlogo" src="assets/images/coreflex-logo.png" style="height:28px;width:140px; margin:10px;"><br><b>Copyright
                        &copy; 2018 Coreflex
                        Solutions</b>
                </div>
            </div>
        </div>
    </div>
</div>